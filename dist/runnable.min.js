/**
 * Threadr.js runnable v0.0.1-b1407312225
 * https://github.com/bbuecherl/Threadr
 * License: MIT http://bbuecherl.mit-license.org/ */
var emitter=function(a){var b={};return a.on=function(c,d){return(b[c]=b[c]||[]).push(d),a},a.off=function(c,d){var e,f=b[c]||[];if("function"==typeof d){for(;(e=f.indexOf(d))>-1;)f.splice(e,1);b[c]=f}else b[c]=[];return a},function(c,d){var e=b[c]||[],f=e.length;for(d=d||[];f>0;)e[--f].apply(a,d)}},ThreadrRunnable=function(a,b,c,d,e,f){this.params=[],this.applier=[],this.childs=[],this.workerSupport;try{this.workerSupport="undefined"!=typeof Worker}catch(g){this.workerSupport=!1}for(var h in b)this.params.push(h),this.applier.push(b[h]);this.genId=function(){var a=0;return function(){return a++}}();var i=this,j={post:function(a,b){d({threadr:"post",name:a,args:b})},load:function(a,b){e(a),b()},terminate:function(){f()},location:c,Threadr:{spawn:function(a){var b=i.genId();d({threadr:"spawn",source:a.toString(),id:b});var c={start:function(){return d({threadr:"start",id:b}),c},terminate:function(){return d({threadr:"terminate",id:b}),c},running:!0,post:function(a,e){return d({threadr:"suppost",id:b,name:a,args:e}),c}},e=emitter(c);return i.childs.push({id:b,emitter:e,thread:c}),c}}};this.emit=emitter(j),this.overrides={post:j.post,on:j.on,off:j.off,load:j.load,Threadr:j.Threadr,terminate:j.terminate,location:j.location,self:j,window:j,reference:void 0,scope:void 0,emitter:void 0,runnable:void 0,ThreadrRunnable:void 0,importScripts:void 0,close:void 0,postMessage:void 0,onmessage:void 0,onerror:void 0};for(var k in this.overrides)-1===this.params.indexOf(k)&&(this.params.push(k),this.applier.push(this.overrides[k]));var l=Function.apply(j,this.params.concat(a));l.apply(j,this.applier)},runnable;onmessage=function(a){if(a.data.threadr)switch(a.data.threadr){case"init":runnable||(runnable=new ThreadrRunnable(a.data.source,a.data.params,a.data.loc,postMessage,importScripts,close));break;case"post":runnable&&runnable.emit(a.data.name,a.data.args);break;case"subpost":runnable&&runnable.childs&&runnable.childs[a.data.id]&&runnable.childs[a.data.id].emitter(a.data.name,a.data.args)}};